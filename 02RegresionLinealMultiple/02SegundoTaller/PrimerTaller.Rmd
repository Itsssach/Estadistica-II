---
output: 
  stevetemplates::article:
    fig_caption: true
#bibliography: master.bib
biblio-style: apsr
title: "Taller Práctico Regresión Lineal Múltiple (2)"
thanks: "El material asociado a este taller puede encontrarse en el repositorio del curso, **(https://github.com/Itsssach/Estadistica-II)**"
author:
- name: Estadística II
  affiliation: Universidad Nacional de Colombia, Sede Medellín
abstract: "Este documento corresponde al quinto taller práctico del curso de **Estadística II** para la *Universidad Nacional de Colombia*, Sede Medellín, en el periodo 2024 - 2. Se brinda una introducción al análisis de regresión. El enfoque de este taller está la comprensión del análisis de varianza y la ejecución de pruebas de hipótesis a través de la suma extra de cuadrados y el método lineal general. **Monitor:** *Santiago Carmona Hincapié.*"
keywords: "regresión múltiple, pruebas hipótesis, ANOVA"
date: "`r format(Sys.time(), '%B %d, %Y')`"
geometry: margin=1in
#fontfamily: mathpazo
fontsize: 12pt
# spacing: double
endnote: no
language: "es"
header-includes:
  - \usepackage{bm}
---

```{r setup, include=FALSE}
# -----------------------------
if (!dir.exists("figs")) dir.create("figs")
if (!dir.exists("_cache")) dir.create("_cache")
# -----------------------------
knitr::opts_chunk$set(cache=TRUE,
                      message=FALSE, warning=FALSE,
                      fig.path='figs/',
                      cache.path = '_cache/',
                      fig.process = function(x) {
                      x2 = sub('-\\d+([.][a-z]+)$', '\\1', x)
                      if (file.rename(x, x2)) x2 else x
                      })
```

```{r, echo=FALSE}
# -----------------------------
#           Libraries
# -----------------------------
if(!require(pacman)){install.packages("pacman"); library(pacman)}
pacman::p_load("tidyverse", "knitr", "leaps","tidyr",
               "exams","leaps","MASS","rsm","car","magrittr",
               "readxl", "kableExtra")
```

```{r, echo=FALSE}
# -----------------------------
#           Read data
# -----------------------------
data <- read.csv("data/students_performance.csv")|> 
  dplyr::select(Overall_PE_Performance_Score, Strength_Score, 
                Skills_Score, Speed_Agility_Score)
colnames(data) <- c("Performance", "Strength", "Skills", "Speed")
```

# Información general

Con el propósito de profundizar en los conceptos del modelo de regresión lineal múltiple vistos en clase, se propone afrontar este taller en dos partes, una de teoría básica y otra práctica.

**La solución para cada uno de los problemas se efectúa a partir del software estadístico R.**

## Parte teórica

De respuesta a las preguntas formuladas a continuación en base a la teoría tratada en clase. **Provea una interpretación de ser necesario**.

\begin{enumerate}
  \item Considere el siguiente modelo de regresión lineal múltiple con $k$ variables regresoras, $p = (k+1)$ parámetros asociados $Y_{i} = \beta_{0} + \beta_{1}X_{i1}+ \beta_{2}X_{i2} + ... + \beta_{k}X_{ik} + \varepsilon_{i}, \varepsilon_{i} \overset{iid}{\sim} N(0, \sigma^{2})$. 
  \begin{itemize}
    \item (a) Escriba el modelo de forma matricial junto con sus supuestos. \textbf{Especifique las dimensiones de cada componente}.
    \item (b) Demuestre que el estimador $\bm{\hat{\beta}}$ que se obtiene a través del método de mínimos cuadrados es un estimador insesgado para $\bm{\beta}$. Analice $\bm{\hat{\beta}}$.  
  \end{itemize}
  \item Determine el valor de verdad de las siguientes afirmaciones.
  \begin{itemize}
    \item (a) Una suma de cuadrados extra mide la reducción marginal en el $\text{SSE}$ cuando una o varias variables predictoras son agregadas al modelo de regresión, dado que las otras predictoras ya fueron agregadas o están en el modelo.
    \item (b) El estadístico $\text{T}$ correspondiente al procedimiento de prueba empleado para probar la significancia marginal del parámetro $j$ es:
    \begin{center}
    $\text{T}_{0} = \displaystyle \frac{\hat{\beta_{j}}-0}{\sqrt{\sigma^{2}c_{jj}}} \sim t_{n-p}$
    \end{center}
    Con una región de rechazo asociada de $\text{R}_{c}= \{|\text{T}_{0}| > t_{\alpha/2, np} \}$ y $p$- valor $P(|t_{n-p}| > |T_{0}|)$.
    \item (c) Valores grandes de $R^{2}$ implican que la superficie ajustada de respuesta es útil; sin embargo, es menos preferido que $R^{2}_{adj}$ como medida de bondad de ajuste.
    \item (d) El estadístico $\text{F}$ correspondiente al procedimiento de prueba empleado para probar la significancia global del modelo de regresión lineal múltiple es:
    \begin{center}
    $\text{F}_{0}= \displaystyle \frac{\text{SSR}/(k)}{\text{SSE}/n-k} \sim f_{k, n- k}$
    \end{center}
    Con una región de rechazo asociada de $\text{R}_{c}= \{\text{F}_{calc} > f_{\alpha, k,n-k} \}$ y $p$- valor $P(f_{k,n-k}> F_{calc})$.
  \end{itemize}
\end{enumerate}

## Ejercicio con datos reales

Considere el siguiente conjunto de datos que agrupa una serie de métricas enfocadas en evaluar el rendimiento en educación física de estudiantes en una institución. **Se incluyen únicamente las métricas cuantitativas,** cuya descripción puede encontrarse **en el siguiente enlace:** https://www.kaggle.com/datasets/ziya07/student-physical-education-performance

```{r, echo=FALSE}
table <- head(data, 5)
table |> 
  knitr::kable(booktabs= TRUE, 
  caption= "Información en análisis", 
               align= "c") |> # Kable Table
  kableExtra::kable_styling(full_width= FALSE, latex_options= 
                              "HOLD_position", font_size= 10) |> 
  kableExtra::column_spec(1, bold = TRUE) # Boldness
```

Considere a *'Overall Performance'* como la variable respuesta. *Las covariables en análisis se especifican en la tabla mostrada con anterioridad.* **Suponga que los supuestos del modelo se cumplen. De respuesta a los siguientes planteamientos:**

\begin{enumerate}
\item Determine cuál es el modelo empleado en esta situación, junto con sus supuestos, además, reporte la recta de regresión ajustada.  
\item Determine la significancia de los parámetros individuales $\beta_{j}$, junto con intervalo de confianza. Brinde una interpretación apropiada.
\item Determina la significancia de la regresión global. ¿Cree que puede realizarse esta prueba empleando otros métodos?
\item Determine si el efecto de (...),
\end{enumerate}

**Tarea:** Construya el valor de la estimación para la varianza $\hat{\sigma}^{2}$. (**Ayuda:** Emplee el vector anterior). 

```{=html}
<!--
# References
\setlength{\parindent}{-0.2in}
\setlength{\leftskip}{0.2in}
\setlength{\parskip}{8pt}
\vspace*{-0.2in}
\noindent
-->
```
